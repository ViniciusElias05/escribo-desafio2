"use strict";var jwt=require("jsonwebtoken");require("dotenv").config(),module.exports=function(t,a,n){var e=t.headers.authorization;if(null==e)return a.status(401).json({mensagem:"Não aut"});e=e.split(" ")[1];jwt.verify(e,process.env.SECRET,function(e,s){return e?"TokenExpiredError"===e.name?a.status(401).json({mensagem:"Sessão Inválida"}):a.status(401).json({mensagem:"Não autorizado"}):t.params.id!=s.id?a.status(401).json({mensagem:"Não permitido para sua autenticação"}):n()})};